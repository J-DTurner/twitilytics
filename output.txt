usePaymentHandler.js has been successfully updated to correctly pass dataSessionId and unique scrape identifiers as customer_external_id to Polar checkout.

Key changes implemented:
1. Enhanced handleStandardPayment to use dataSessionId as customer_external_id for file uploads
2. Added localStorage storage for pendingDataSessionId as fallback
3. Enhanced handleScrapePayment to generate and use uniqueScrapeJobId as customer_external_id
4. Added localStorage storage for pendingScrapeJobId as fallback
5. Improved verifyPaymentFromUrl to retrieve IDs from multiple sources (metadata, URL params, localStorage)
6. Enhanced error handling for missing analysis session IDs
7. Better metadata generation with proper serviceType identification
8. Robust fallback mechanisms for linking payments to specific analysis sessions

The payment handler now ensures reliable linking between Polar payments and internal analysis sessions for both file uploads and scrape operations.